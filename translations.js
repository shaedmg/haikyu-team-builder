// Translations for Haikyu Team Builder
const translations = {
  en: {
    // Header
    title: 'üèê Haikyu Flight High Team Builder',
    subtitle:
      'Create Perfect Volleyball Teams with Character Bonds & School Synergies',

    // Main sections
    schoolBonds: 'School Bonds',
    bonds: 'Bonds',
    selectPlayers: 'Select Players',

    // Positions (keep original)
    opposite: 'Opposite',
    middleBlocker: 'Middle Blocker',
    wingSpiker: 'Wing Spiker',
    setter: 'Setter',
    libero: 'Libero',

    // Modal
    height: 'Height:',
    position: 'Position:',
    power: 'Power:',
    selectPlayer: 'Select Player',
    playerBonds: 'Character Bonds:',

    // Rotation
    rotateTooltip: 'Rotate players clockwise',

    // Team/Bonds Status Messages
    noPlayersSelected: 'No players selected',
    noBondsAvailable: 'No bonds available',
    noDetailedEffects: 'Bond without detailed effects:',
    bondType: 'Type:',
    linkSkill: 'Link Skill',
    kizunaSkill: 'Kizuna Skill',

    // Bond Effects
    characterEffects: 'Character Effects:',
    effectsPerCharacter: 'Effects per Character:',
    kizunaSkillType: 'üîó Kizuna Skill',
    specialEffect: 'Special effect',
    effectNotSpecified: 'Effect not specified',
    noLevelsAvailable: 'No levels available',

    // Bonus value translations
    points: 'points',
    additional: 'additional',

    // Attributes (common bonus types)
    attack: 'Attack',
    defense: 'Defense',
    speed: 'Speed',
    stamina: 'Stamina',
    technique: 'Technique',
    mental: 'Mental',
    serve: 'Serve',
    receive: 'Receive',
    block: 'Block',
    spike: 'Spike',
    bloqueo: 'Block',
    ataque: 'Attack',
    defensa: 'Defense',
    velocidad: 'Speed',
    resistencia: 'Stamina',
    tecnica: 'Technique',
    saque: 'Serve',
    recepcion: 'Receive',
    remate: 'Spike',
    colocacion: 'Setting',

    // Specific attribute translations
    saque: 'Serve',
    colocaci√≥n: 'Setting',
    remate: 'Spike',
    'bloqueo de l√≠nea delantera (equipo)': 'Front Line Block (Team)',
    'ataque r√°pido': 'Quick Attack',
    'esp√≠ritu competitivo': 'Competitive Spirit',
    reacci√≥n: 'Reaction',
    'defensa sin fisuras': 'Seamless Defense',
    conciencia: 'Awareness',

    // Specific bond name translations from JSON
    'd√∫o de raros': 'Rare Duo',
    'contemplando los cerezos en flor': 'Cherry Blossom Viewing',
    'compa√±eros de pr√°ctica de tokio': 'Tokyo Practice Partners',
    'bloqueadores centrales de shiratorizawa': 'Shiratorizawa Central Blockers',
    'bloqueadores centrales de fukur≈çdani': 'Fukurodani Central Blockers',
    'primer disc√≠pulo': 'First Disciple',
    'expectativa del senpai': "Senpai's Expectation",

    // Meta tags
    metaDescription:
      'üèê Build your perfect Haikyu Flight High volleyball team! Create teams with Karasuno, Nekoma, Shiratorizawa characters. Interactive team builder with bonds, statistics and school synergies. Free Haikyu team planner tool.',
    metaKeywords:
      'haikyu flight high team builder, haikyu fly high team, haikyu volleyball team creator, haikyu team planner, haikyu flight high characters, haikyu team composition, karasuno team builder, nekoma team builder, shiratorizawa team builder, haikyu bonds calculator, volleyball team simulator, haikyu game team, anime volleyball team, haikyu interactive tool, haikyu team optimizer, flight high team maker, haikyu squad builder, volleyball anime team',
    pageTitle:
      'Haikyu Flight High Team Builder | Create Perfect Volleyball Teams | Free Online Tool',

    // Language selector
    language: 'Language:',
    english: 'English',
    spanish: 'Espa√±ol',
  },

  es: {
    // Header
    title: 'üèê Constructor de Equipos Haikyu Flight High',
    subtitle:
      'Crea Equipos de Voleibol Perfectos con V√≠nculos de Personajes y Sinergias Escolares',

    // Main sections
    schoolBonds: 'V√≠nculos por Escuela',
    bonds: 'V√≠nculos',
    selectPlayers: 'Seleccionar Jugadores',

    // Positions (keep original)
    opposite: 'Opposite',
    middleBlocker: 'Middle Blocker',
    wingSpiker: 'Wing Spiker',
    setter: 'Setter',
    libero: 'Libero',

    // Modal
    height: 'Altura:',
    position: 'Posici√≥n:',
    power: 'Poder:',
    selectPlayer: 'Seleccionar Jugador',
    playerBonds: 'V√≠nculos de este Personaje:',

    // Rotation
    rotateTooltip: 'Rotar jugadores en sentido horario',

    // Team/Bonds Status Messages
    noPlayersSelected: 'No hay jugadores seleccionados',
    noBondsAvailable: 'No hay v√≠nculos disponibles',
    noDetailedEffects: 'V√≠nculo sin efectos detallados:',
    bondType: 'Tipo:',
    linkSkill: 'Link Skill',
    kizunaSkill: 'Kizuna Skill',

    // Bond Effects
    characterEffects: 'Efectos por Personaje:',
    effectsPerCharacter: 'Efectos por Personaje:',
    kizunaSkillType: 'üîó Habilidad Kizuna',
    specialEffect: 'Efecto especial',
    effectNotSpecified: 'Efecto no especificado',
    noLevelsAvailable: 'Sin niveles disponibles',

    // Bonus value translations
    points: 'puntos',
    additional: 'adicional',

    // Attributes (common bonus types)
    attack: 'Ataque',
    defense: 'Defensa',
    speed: 'Velocidad',
    stamina: 'Resistencia',
    technique: 'T√©cnica',
    mental: 'Mental',
    serve: 'Saque',
    receive: 'Recepci√≥n',
    block: 'Bloqueo',
    spike: 'Remate',
    bloqueo: 'Bloqueo',
    ataque: 'Ataque',
    defensa: 'Defensa',
    velocidad: 'Velocidad',
    resistencia: 'Resistencia',
    tecnica: 'T√©cnica',
    saque: 'Saque',
    recepcion: 'Recepci√≥n',
    remate: 'Remate',
    colocacion: 'Colocaci√≥n',

    // Specific attribute translations
    serve: 'Saque',
    setting: 'Colocaci√≥n',
    spike: 'Remate',
    'front line block (team)': 'Bloqueo de l√≠nea delantera (equipo)',
    'quick attack': 'Ataque r√°pido',
    'competitive spirit': 'Esp√≠ritu competitivo',
    reaction: 'Reacci√≥n',
    'seamless defense': 'Defensa sin fisuras',
    awareness: 'Conciencia',

    // Specific bond name translations from JSON
    'rare duo': 'D√∫o de Raros',
    'cherry blossom viewing': 'Contemplando los Cerezos en Flor',
    'tokyo practice partners': 'Compa√±eros de Pr√°ctica de Tokio',
    'shiratorizawa central blockers': 'Bloqueadores Centrales de Shiratorizawa',
    'fukurodani central blockers': 'Bloqueadores Centrales de Fukur≈çdani',
    'first disciple': 'Primer Disc√≠pulo',
    "senpai's expectation": 'Expectativa del Senpai',

    // Meta tags
    metaDescription:
      'üèê ¬°Construye tu equipo perfecto de Haikyu Flight High! Crea equipos con personajes de Karasuno, Nekoma, Shiratorizawa. Constructor de equipos interactivo con v√≠nculos, estad√≠sticas y sinergias escolares. Herramienta gratuita de planificaci√≥n de equipos Haikyu.',
    metaKeywords:
      'constructor equipos haikyu flight high, equipo haikyu fly high, creador equipos voleibol haikyu, planificador equipos haikyu, personajes haikyu flight high, composici√≥n equipos haikyu, constructor equipos karasuno, constructor equipos nekoma, constructor equipos shiratorizawa, calculadora v√≠nculos haikyu, simulador equipos voleibol, equipo juego haikyu, equipo voleibol anime, herramienta interactiva haikyu, optimizador equipos haikyu, creador equipos flight high, constructor escuadras haikyu, equipo anime voleibol',
    pageTitle:
      'Constructor de Equipos Haikyu Flight High | Crea Equipos de Voleibol Perfectos | Herramienta Gratuita Online',

    // Language selector
    language: 'Idioma:',
    english: 'English',
    spanish: 'Espa√±ol',
  },
};

// Language manager class
class LanguageManager {
  constructor() {
    this.currentLanguage = localStorage.getItem('haikyu-language') || 'en';
    this.init();
  }

  init() {
    this.createLanguageSelector();
    this.applyLanguage(this.currentLanguage);
  }

  createLanguageSelector() {
    const header = document.querySelector('.header');

    // Create language selector container
    const languageContainer = document.createElement('div');
    languageContainer.className = 'language-selector';

    languageContainer.innerHTML = `
      <label for="languageSelect">${
        translations[this.currentLanguage].language
      }</label>
      <select id="languageSelect">
        <option value="en" ${this.currentLanguage === 'en' ? 'selected' : ''}>${
      translations.en.english
    }</option>
        <option value="es" ${this.currentLanguage === 'es' ? 'selected' : ''}>${
      translations.es.spanish
    }</option>
      </select>
    `;

    // Insert after the subtitle
    const subtitle = header.querySelector('.header-subtitle');
    subtitle.insertAdjacentElement('afterend', languageContainer);

    // Add event listener
    document
      .getElementById('languageSelect')
      .addEventListener('change', (e) => {
        this.changeLanguage(e.target.value);
      });
  }

  changeLanguage(lang) {
    this.currentLanguage = lang;
    localStorage.setItem('haikyu-language', lang);
    this.applyLanguage(lang);

    // Reload data with appropriate language JSON
    if (window.teamBuilder) {
      console.log('=== LANGUAGE CHANGE: Reloading data ===');
      console.log('New language:', lang);

      // Reload the JSON data for the new language
      window.teamBuilder
        .loadPlayers(lang)
        .then(() => {
          // Update the UI with new data
          window.teamBuilder.updateBonds();
          window.teamBuilder.updateSchoolStats();
          console.log('=== Data reloaded successfully ===');
        })
        .catch((error) => {
          console.error('Error reloading data:', error);
        });
    }
  }

  applyLanguage(lang) {
    const t = translations[lang];

    // Update page title
    document.title = t.pageTitle;

    // Update meta tags
    document
      .querySelector('meta[name="description"]')
      .setAttribute('content', t.metaDescription);
    document
      .querySelector('meta[name="keywords"]')
      .setAttribute('content', t.metaKeywords);
    document.querySelector('html').setAttribute('lang', lang);

    // Update main content
    document.querySelector('.header h1').textContent = t.title;
    document.querySelector('.header-subtitle').textContent = t.subtitle;

    // Update section headings
    document.querySelector('#school-heading').textContent = t.schoolBonds;
    document.querySelectorAll('.school-panel h2')[1].textContent = t.bonds;
    document.querySelector('#players-heading').textContent = t.selectPlayers;

    // Update modal labels
    document.querySelector('#heightLabel').textContent = t.height;
    document.querySelector('#positionLabel').textContent = t.position;
    document.querySelector('#powerLabel').textContent = t.power;
    document.querySelector('#selectPlayerBtn').textContent = t.selectPlayer;
    document.querySelector('.bonds-section-title').textContent = t.playerBonds;

    // Update rotation button tooltip
    document
      .querySelector('#rotationButton')
      .setAttribute('title', t.rotateTooltip);

    // Update language selector label
    if (document.querySelector('.language-selector label')) {
      document.querySelector('.language-selector label').textContent =
        t.language;
    }

    // Update Open Graph and Twitter meta tags
    this.updateMetaTags(lang, t);
  }

  updateMetaTags(lang, t) {
    // Update Open Graph
    document
      .querySelector('meta[property="og:title"]')
      .setAttribute('content', t.pageTitle);
    document
      .querySelector('meta[property="og:description"]')
      .setAttribute('content', t.metaDescription);
    document
      .querySelector('meta[property="og:locale"]')
      .setAttribute('content', lang === 'es' ? 'es_ES' : 'en_US');

    // Update Twitter
    document
      .querySelector('meta[property="twitter:title"]')
      .setAttribute('content', t.pageTitle);
    document
      .querySelector('meta[property="twitter:description"]')
      .setAttribute('content', t.metaDescription);

    // Update hreflang
    const currentUrl = window.location.origin + window.location.pathname;
    document
      .querySelector('link[rel="alternate"][hreflang="en"]')
      .setAttribute('href', currentUrl);
    document
      .querySelector('link[rel="alternate"][hreflang="es"]')
      .setAttribute('href', currentUrl + (lang === 'es' ? 'es/' : ''));
  }

  t(key) {
    return translations[this.currentLanguage][key] || key;
  }

  // Method to get current language
  getCurrentLanguage() {
    return this.currentLanguage;
  }

  // Method to translate bond names (simplified - now comes from JSON)
  translateBondName(bondName) {
    // Since we now load the appropriate JSON based on language,
    // bond names should already be in the correct language
    return bondName;
  }

  // Method to translate attributes (simplified - now comes from JSON)
  translateAttribute(attribute) {
    // Since we now load the appropriate JSON based on language,
    // attributes should already be in the correct language
    return attribute;
  }
}

// Export for use in other files
window.LanguageManager = LanguageManager;
window.translations = translations;
